<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>商品コピーチェッカー</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🔍 商品コピーチェッカー</h1>
            <p class="subtitle">薬機法・景表法に基づく商品コピーの自動チェックツール</p>
        </header>

        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-button active" data-tab="single">単一チェック</button>
            <button class="tab-button" data-tab="batch">一括チェック (Excel)</button>
        </div>

        <!-- Single Check Tab -->
        <div class="tab-content active" id="single-tab">
            <div class="card">
                <h2>単一商品のチェック</h2>
                
                <div class="form-group">
                    <label for="skill-select">スキル選択:</label>
                    <select id="skill-select" class="form-control">
                        <option value="商品コピーチェック">商品コピーチェック</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="product-info">商品情報:</label>
                    <textarea 
                        id="product-info" 
                        class="form-control" 
                        rows="10" 
                        placeholder="商品名: テスト商品&#10;*変更前_商品の特徴BtoB: 高品質な素材を使用...&#10;*変更前_キャッチコピーBtoC: 健康をサポート！"
                    ></textarea>
                    <small class="help-text">商品情報を自由形式で入力してください</small>
                </div>

                <button id="check-button" class="btn btn-primary">チェック実行</button>

                <div id="single-result" class="result-container" style="display: none;">
                    <h3>チェック結果</h3>
                    <div id="single-conclusion" class="conclusion"></div>
                    <div id="single-details" class="details"></div>
                    <div id="single-usage" class="usage-info"></div>
                </div>

                <div id="single-loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>チェック中...</p>
                </div>

                <div id="single-error" class="error-message" style="display: none;"></div>
            </div>
        </div>

        <!-- Batch Check Tab -->
        <div class="tab-content" id="batch-tab">
            <div class="card">
                <h2>Excelファイルによる一括チェック</h2>
                
                <div class="info-box">
                    <h4>📋 使い方:</h4>
                    <ol>
                        <li><strong>シート名:</strong> 「チェック対象」という名前のシートを作成してください</li>
                        <li><strong>必須列:</strong> 「*商品名」列が必須です</li>
                        <li><strong>チェック対象列:</strong> 以下の列にチェック対象テキストを記載
                            <ul style="margin-top: 5px; margin-bottom: 5px;">
                                <li>*変更前_商品の特徴BtoB</li>
                                <li>*変更前_MDおすすめコメントBtoB</li>
                                <li>*変更前_短いキャッチコピーBtoB</li>
                                <li>*変更前_キャッチコピーBtoC</li>
                                <li>*変更前_商品の特徴BtoC</li>
                            </ul>
                        </li>
                        <li>各行が1つの商品を表します（ヘッダー行を除く）</li>
                        <li>ファイルをアップロードして「一括チェック実行」をクリック</li>
                        <li>結果がExcelファイルでダウンロードされます（「チェック結果」「結論」列が追加されます）</li>
                    </ol>
                </div>

                <div class="form-group">
                    <label for="excel-file">Excelファイル:</label>
                    <input 
                        type="file" 
                        id="excel-file" 
                        class="form-control" 
                        accept=".xlsx,.xls,.xlsm"
                    >
                    <small class="help-text">アップロード可能な形式: .xlsx (Excel 2007以降), .xls (Excel 97-2003), .xlsm (マクロ有効ブック)</small>
                </div>

                <div class="form-group">
                    <label for="batch-skill-select">スキル選択:</label>
                    <select id="batch-skill-select" class="form-control">
                        <option value="商品コピーチェック">商品コピーチェック</option>
                    </select>
                </div>

                <button id="batch-check-button" class="btn btn-primary" disabled>一括チェック実行</button>

                <div id="batch-loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>一括チェック中... しばらくお待ちください</p>
                </div>

                <div id="batch-error" class="error-message" style="display: none;"></div>
            </div>
        </div>

        <footer>
            <p>Powered by LiteLLM API</p>
            <p class="note">※ このツールは一次チェックを支援するものです。最終判断は必ず専門家が行ってください。</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>
